name: Update year
on:
  workflow_dispatch:
    inputs:
      aoc_year:
        description: 'Advent of Code year'
        required: true
        default: 'yyyy'
jobs:
  verify:
    runs-on: ubuntu-latest
    steps: 
      - name: Check Repository
        run: |
          if [ "${{ github.repository }}" == "Flashky/advent-of-code-yyyy" ]; then
            echo "Error: This workflow cannot be run from the template repository."
            exit 1
          fi
      - name: Check Year Format
        run: |
          if echo "${{ github.event.inputs.aoc_year }}" | grep -E -q '^[0-9]{4}$'; then
            echo "Year '${{ github.event.inputs.aoc_year }}' format is valid."
          else
            echo "Error: Invalid year format ('${{ github.event.inputs.aoc_year }}'). Please provide a valid 4-digit year."
            exit 1
          fi
  update-year:
    needs: verify
    runs-on: ubuntu-latest
    steps:
    - uses: actions/checkout@v3
    - name: Update README.md
      run: |
        find . -name 'README.md' | xargs sed -i 's/{year}/'${{ github.event.inputs.aoc_year }}'/g'
    - name: Update pom.xml
      run: |
        find . -name 'pom.xml' | xargs sed -i 's/yyyy/'${{ github.event.inputs.aoc_year }}'/g'
    - name: Check changes
      run: |
        git status
        
